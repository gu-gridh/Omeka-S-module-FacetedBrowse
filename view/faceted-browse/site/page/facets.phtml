<button id="section-sidebar-modal-close" class="close-button" aria-label="<?php echo $this->escapeHtml($this->translate('Close')); ?>" aria-labelledby="section-sidebar-modal-close section-sidebar" type="button">
  <span aria-hidden="true" class="close-glyph"></span>
</button>
<div class="sr-only" id="facet-modal-description">
    This is a dialog window which overlays the main content of the page. The modal begins with a fieldset called <?php echo $category->name(); ?>. Pressing the Close Modal button at the top right of the modal will close the modal and bring you back to where you were on the page.
</div>
<?php echo $this->hyperlink($this->translate('Back'), [], ['id' => 'categories-return', 'class' => 'button']); ?>
<fieldset class="facets-container">
    <legend><?php echo $category->name(); ?></legend>
    <?php $userText = $category->userText(); ?>
    <?php if ($userText): ?>
    <a id="user-text-expand" href="#"><?php echo $this->translate('View info'); ?></a>
    <a id="user-text-collapse" href="#"><?php echo $this->translate('Collapse info'); ?></a>
    <div id="user-text"><?php echo $category->userText(); ?></div>
    <?php endif; ?>
    <div id="facets"
        data-category-id="<?php echo $this->escapeHtml($category->id()); ?>"
        data-category-query="<?php echo $this->escapeHtml($category->query()); ?>">
        <?php foreach ($category->facets() as $facet): ?>
        <?php if ($this->facetedBrowse()->facetIsKnown($facet)): ?>
        <fieldset class="facet"
            data-facet-id="<?php echo $this->escapeHtml($facet->id()); ?>"
            data-facet-type="<?php echo $this->escapeHtml($facet->type()); ?>"
            data-facet-data="<?php echo $this->escapeHtml(json_encode($facet->data())); ?>">
            <legend><?php echo $facet->name(); ?></legend>
            <?php echo $this->facetedBrowse()->renderFacet($facet); ?>
        </fieldset>
        <?php endif; ?>
        <?php endforeach; ?>
    </div>
</fieldset>
<script>
// Handle user info collapse/expand.
const userText = $('#user-text');
const userTextExpand = $('#user-text-expand');
const userTextCollapse = $('#user-text-collapse');
userText.hide();
userTextCollapse.hide();
userTextExpand.on('click', function(e) {
    e.preventDefault();
    userTextExpand.hide();
    userTextCollapse.show();
    userText.show();
});
userTextCollapse.on('click', function(e) {
    e.preventDefault();
    userTextExpand.show();
    userTextCollapse.hide();
    userText.hide();
});
</script>
